# include ~/.config/sway/config.d/catppuccin-mocha

### Variables

set $mod Mod1
set $left h
set $down j
set $up k
set $right l
set $term kitty
# set $menu wofi --show drun
set $menu rofi -terminal '$term' -show combi -combi-modes drun#run -modes combi
set $laptop_display "eDP-1"
set $laptop_display_touch "1386:21256:Wacom_HID_5308_Finger"
set $laptop_pen "1386:21256:Wacom_HID_5308_Pen"

### Executions

exec {
    swaybg -i "$(find ~/Pictures/Wallpapers/ -type f | shuf -n 1)" -m fill -c 1a1b26
    ~/.local/scripts/sway_display_lid.sh
    ~/.local/scripts/sway_display_orientation.sh
    # swayidle -w
}

exec_always systemctl --user start sway-session.target

# exec gammastep

### Laptop lid

bindswitch --reload --locked {
    lid:on output $laptop_display disable
    lid:off output $laptop_display enable
}

### Output configuration
# You can get the names of your outputs by running: swaymsg -t get_outputs
# output "*" bg "#002244" solid_color

output $laptop_display {
    scale 1.25
    # allow_tearing yes
    # max_render_time off
}

### Input configuration
# You can get the names of your inputs by running: swaymsg -t get_inputs

input $laptop_display_touch map_to_output $laptop_display
# input $laptop_pen map_to_output $laptop_display

input type:keyboard {
    xkb_layout us,ru
    xkb_variant ,
    xkb_model pc104
    xkb_options grp:win_space_toggle,caps:none
}

input type:touchpad {
    tap enabled
    natural_scroll disabled
    clickfinger_button_map lrm
    drag disabled
    drag_lock disabled
    dwt enable
    scroll_method two_finger
    scroll_factor 2.0
    # pointer_accel -0.1
}

# input $laptop_pen {
#     # tool_mode pen relative
#     # tool_mode pen absolute
#     # pointer_accel 0.0
#     # accel_profile flat
#     # scroll_factor 1.0
# }

input type:pointer {
    pointer_accel -0.5
}

input '2:10:TPPS/2_Elan_TrackPoint' {
    pointer_accel -0.6
}
### Workspaces and apps

workspace 1
workspace 2
workspace 3
workspace 4
workspace 5
workspace 6
workspace 7
workspace 8
workspace 9
workspace 10

workspace back_and_forth yes

# assign windows to specific workspace by using the app_id
# swaymsg -t get_tree
assign [app_id="kitty"] workspace 1
assign [app_id="brave-browser"] workspace 2
assign [app_id="org.mozilla.firefox"] workspace 2
assign [app_id="org.telegram.desktop"] workspace 3
assign [app_id="org.remmina.Remmina"] workspace 4
# TODO add floating for password prompt when open from browser
# assign [app_id="org.keepassxc.KeePassXC"] workspace 5
# assign [title='Unlock Database - KeePassXC'] workspace 5

# for_window [app_id="org.keepassxc.KeePassXC" title="Unlock Database - KeePassXC"] {
#     floating enable
# }
for_window [class="^(steam$)" title="^(?!Steam$)"] floating enable
for_window [window_role = "pop-up"] floating enable
for_window [window_role = "bubble"] floating enable
for_window [window_role = "dialog"] floating enable
for_window [window_type = "dialog"] floating enable
for_window [window_role = "task_dialog"] floating enable
for_window [window_type = "menu"] floating enable
for_window [app_id = "floating"] floating enable
for_window [app_id = "floating_update"] floating enable, resize set width 1000px height 600px
for_window [class = "(?i)pinentry"] floating enable
for_window [title = "Administrator privileges required"] floating enable

### Key bindings

bindsym --to-code {
    $mod+Return exec $term
    $mod+Shift+q kill
    $mod+d exec $menu
    $mod+Shift+c reload
    # $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

    #TODO Setup
    # $mod+Shift+k exec swaymsg exit
    # $mod+l exec swaylock -f
}

floating_modifier $mod normal

bindsym --to-code {
    $mod+$left focus left
    $mod+$down focus down
    $mod+$up focus up
    $mod+$right focus right
    $mod+Left focus left
    $mod+Down focus down
    $mod+Up focus up
    $mod+Right focus right
}

bindsym --to-code {
    $mod+Shift+$left move left
    $mod+Shift+$down move down
    $mod+Shift+$up move up
    $mod+Shift+$right move right
    $mod+Shift+Left move left
    $mod+Shift+Down move down
    $mod+Shift+Up move up
    $mod+Shift+Right move right
}

bindsym --to-code {
    $mod+1 workspace number 1
    $mod+2 workspace number 2
    $mod+3 workspace number 3
    $mod+4 workspace number 4
    $mod+5 workspace number 5
    $mod+6 workspace number 6
    $mod+7 workspace number 7
    $mod+8 workspace number 8
    $mod+9 workspace number 9
    $mod+0 workspace number 10
    $mod+tab workspace back_and_forth
}

bindsym --to-code {
    $mod+Shift+1 move container to workspace number 1
    $mod+Shift+2 move container to workspace number 2
    $mod+Shift+3 move container to workspace number 3
    $mod+Shift+4 move container to workspace number 4
    $mod+Shift+5 move container to workspace number 5
    $mod+Shift+6 move container to workspace number 6
    $mod+Shift+7 move container to workspace number 7
    $mod+Shift+8 move container to workspace number 8
    $mod+Shift+9 move container to workspace number 9
    $mod+Shift+0 move container to workspace number 10
}

bindsym --to-code {
    $mod+b splith
    $mod+v splitv
}

bindsym --to-code {
    $mod+s layout stacking
    $mod+w layout tabbed
    $mod+e layout toggle split
    $mod+f fullscreen
    $mod+Shift+space floating toggle
    $mod+space focus mode_toggle
    $mod+a focus parent
}

mode "resize" {
    bindsym --to-code {
        $left resize shrink width 10px
        $down resize grow height 10px
        $up resize shrink height 10px
        $right resize grow width 10px
        Left resize shrink width 10px
        Down resize grow height 10px
        Up resize shrink height 10px
        Right resize grow width 10px
        Return mode "default"
        Escape mode "default"
    }
}

bindsym --to-code $mod+r mode "resize"

### Borders
default_border pixel 2
default_floating_border pixel 2
# gaps inner 5000
hide_edge_borders --i3 smart

# Include configs from 3 locations:
#  - /usr/share/sway/config.d
#  - /etc/sway/config.d
#  - $XDG_CONFIG_HOME/sway/config.d ($HOME/.config/sway/config.d)
#
# If multiple directories contain the files with the same name, the later
# directory takes precedence; `$XDG_CONFIG_HOME/sway/config.d/20-swayidle.conf`
# will always be loaded instead of `/usr/share/sway/config.d/20-swayidle.conf`
# or `/etc/sway/config.d/20-swayidle.conf`
#
# This mechanism permits overriding our default configuration per-system
# (/etc) or per-user ($XDG_CONFIG_HOME) basis. Just create the file you
# want to modify/override in the higher-level directory.
#
# For example, to disable the default bar from Fedora configs, you'll need to
#     $ echo -n > "$HOME/.config/sway/config.d/90-bar.conf"
#
# Note the quoting, the $() and the arguments quoting. All the parts are equally
# important to make the magic work. And if you want to learn the secret behind
# the trick, it's all in the `wordexp(3)`.
#
# include '$(/usr/libexec/sway/layered-include "/usr/share/sway/config.d/*.conf" "/etc/sway/config.d/*.conf" "${XDG_CONFIG_HOME:-$HOME/.config}/sway/config.d/*.conf")'
include '$(/usr/libexec/sway/layered-include "${XDG_CONFIG_HOME:-$HOME/.config}/sway/config.d/*.conf")'

### Colors
# target                 title     bg    text   indicator  border
client.focused           $lavender $base $text  $rosewater $lavender
client.focused_inactive  $overlay0 $base $text  $rosewater $overlay0
client.unfocused         $overlay0 $base $text  $rosewater $overlay0
client.urgent            $peach    $base $peach $overlay0  $peach
client.placeholder       $overlay0 $base $text  $overlay0  $overlay0
client.background        $base
